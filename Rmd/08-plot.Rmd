---
title: "Visualización básica"
subtitle: "HR Analytics: Teoría y Práctica"
author: "Twitter: @pablohaya"
date: "09/2018"
output:
  beamer_presentation: default
  ioslides_presentation: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Leemos datos

Leemos el conjunto de datos que creamos en el tema anterior como combinación de `core_dataset.csv` y `production_staff.csv`

```{r message=FALSE, warning=FALSE}
library(here)
load(here("data","join_dataset_clean.RData"))
```

## Resumen

Vamos a ver el resumen de la variable `PayRate`. 

```{r}
summary(df$PayRate)
```

---

## Histogramas

Los histogramas nos permiten visualizar la forma que tiene la distribución de una variable empleando la función `hist()`.

```{r}
hist(df$PayRate)
```

---

Es importante tener en cuenta que la elección de los puntos de corte de las barras pueden cambiar el histograma. 

```{r}
hist(df$PayRate, breaks = 3)
```

---

```{r}
hist(df$PayRate, breaks = 30)
```


## Personalizando la gráfica

Es posible personalizar la gráfica incluyendo distitnos parámetros como el título de la gráfica `main`, la etiquetas de los ejes (`xlab`, `ylab`), o subtítulo (`sub`). 

```{r}
hist(df$PayRate, 
     main="Distribución del precio por hora", sub="Sólo aplica a plantilla de producción",
     xlab="Precio (h)", ylab="Frecuencia")
```

---

Los colores y bordes de las barras también se pueden modificar con los parámetros `col` y `border` respectivamente.

```{r}
hist(df$PayRate, 
     main="Distribución del precio por hora", sub="Sólo aplica a plantilla de producción",
     xlab="Precio (h)", ylab="Frecuencia",
     col="azure", 
     border="azure4")
```

---

## Función de densidad

La función de densidad es una aproximación que muestra de manera continua la distribución de una variable.

```{r}
plot(density(df$PayRate))
```

## Gráficos de barras

Los gráficos de barras permiten mostran variables categóricas.

Aunque no se muestra en el gráfico, los parámetros para modificar el color de las barras siguen siendo aplicables.

```{r}
count <- table(df$MaritalDesc)
barplot(count)
```

---

Se puede mostrar el cruce de dos variables categóricas agrupando las barras por colores.

Primero se genera una tabla con las combinaciones, y luego se indican los colores a emplear. Opcionalmente se puede incluir leyenda (`legend`).

```{r}
count <- table(df$Sex, df$MaritalDesc)
barplot(count, col=c("darkseagreen1", "orange"), legend = rownames(count))
```

---

El párametro `beside` permite controlar la posición de las barras.

```{r}
barplot(count, 
        col=c("darkseagreen1", "orange"), legend = rownames(count), 
        beside=TRUE)
```

---

Mientras que el parámetro `horiz` nos permite girar las barras en posición horizontal.

```{r}
barplot(count,
        col=c("darkseagreen1", "orange"), legend = rownames(count),
        beside=TRUE, horiz=TRUE)
```

## Función `plot`

La función genérica `plot()` permite visualizar dos variables eligiendo por el usuario una  representación adecuada.

Por ejemplo, una variable fecha, y una variable númerica visualiza un gráfico de puntos.

```{r}
plot(df$DOB, df$PayRate)
```

---

De nuevo es posible agrupar la gráfica por una variable adicional, y colorear los puntos. Así, como añadir parámetros de personalización anteriormente visto.

```{r}
plot(df$DOB, df$PayRate, col=df$Sex,
     main="Distribución salarial por cohorte",
     xlab="Año nacimiento", ylab="Precio por hora")
```

---

```{r}
plot(df$DOB, df$PayRate, col=df$Sex,
     main="Title", sub="subtitle",
     xlab="Año", ylab="PayRate")
# No se que pasa con la leyenda
#legend(7, 4.3, levels(df$Sex), col=1:length(df$Sex), pch=1)
```


---

## Lista de símbolos disponibles

```{r echo=FALSE}
#++++++++++++++++++++++++++++++++++++++++++++
#generate a plot of point shapes which R knows about.
#++++++++++++++++++++++++++++++++++++++++++++
# source: http://www.sthda.com/english/wiki/r-plot-pch-symbols-the-different-point-shapes-available-in-r
generateRPointShapes<-function(){
  oldPar<-par()
  par(font=2, mar=c(0.5,0,0,0))
  y=rev(c(rep(1,6),rep(2,5), rep(3,5), rep(4,5), rep(5,5)))
  x=c(rep(1:5,5),6)
  plot(x, y, pch = 0:25, cex=1.5, ylim=c(1,5.5), xlim=c(1,6.5), 
       axes=FALSE, xlab="", ylab="", bg="blue")
  text(x, y, labels=0:25, pos=3)
  par(mar=oldPar$mar,font=oldPar$font )
}
generateRPointShapes()
```

## Series temporales

Pintar la evoluación en la contratación

```{r}

```


## Boxplots

```{r}
plot(df$Sex, df$PayRate, main="Title", sub="subtitle",
  xlab="Sex", ylab="PayRate")
# que pasa con la leyenda
legend(7, 4.3, levels(df$Sex), pch=1)
```

---
Visualizar: plot, line, par, pairs
Line plots


When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document.

## Slide with Bullets

- Bullet 1
- Bullet 2
- Bullet 3

## Slide with R Output

```{r echo=FALSE}
table <- data.frame(
            option=c("col", "col.axis", "col.lab", "col.main", "col.sub", "fg", "bg"),
            description=c("color por defecto",
                          "color para los ejes",
                          "color para el título de los ejes",
                          "color para el título principal",
                          "color para el subtítulo",
                          "color de elementos visibles",
                          "color de fondo"))

knitr::kable(table) 
```

## Recursos y material

* [Colores en R](http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf)